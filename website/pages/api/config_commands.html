
<script type="text/javascript" id="documentation_options" data-url_root="./"
  src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<div class="section" id="config-commands">
<h1>Config Commands<a class="headerlink" href="#config-commands" title="Permalink to this headline">¶</a></h1>
<p>This page explains the usage of the commands <code class="docutils literal notranslate"><span class="pre">help-config</span></code> to explore PyText components, and <code class="docutils literal notranslate"><span class="pre">gen-default-config</span></code> to create a config file with custom components and parameters.</p>
<div class="section" id="exploring-config-options">
<h2>Exploring Config Options<a class="headerlink" href="#exploring-config-options" title="Permalink to this headline">¶</a></h2>
<p>You can explore PyText Components with the command <code class="docutils literal notranslate"><span class="pre">help-config</span></code>. This will print the documentation of the component, its full module name, its base class, as well as the list of its config parameters, their type and their default value.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext help-config LMTask
<span class="go">=== pytext.task.tasks.LMTask (NewTask) ===</span>
<span class="go">    data = Data</span>
<span class="go">    exporter = null</span>
<span class="go">    features = FeatureConfig</span>
<span class="go">    featurizer = SimpleFeaturizer</span>
<span class="go">    metric_reporter: LanguageModelMetricReporter = LanguageModelMetricReporter</span>
<span class="go">    model: LMLSTM = LMLSTM</span>
<span class="go">    trainer = TaskTrainer</span>
</pre></div>
</div>
<p>You can drill down to the component you’re interested in. For example, if you want to know more about the model <code class="xref py py-class docutils literal notranslate"><span class="pre">LMLSTM</span></code>, you can use the same command. Notice how PyText lists the possible values for <cite>Union</cite> types (for example with <cite>representation</cite> below.)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext help-config LMLSTM
<span class="go">=== pytext.models.language_models.lmlstm.LMLSTM (BaseModel) ===</span>
<span class="go">"""</span>
<span class="go">`LMLSTM` implements a word-level language model that uses LSTMs to</span>
<span class="go">    represent the document.</span>
<span class="go">"""</span>
<span class="go">    ModelInput = LMLSTM.Config.ModelInput</span>
<span class="go">    caffe2_format: (ExporterType)</span>
<span class="go">         PREDICTOR (default)</span>
<span class="go">         INIT_PREDICT</span>
<span class="go">    decoder: (one of)</span>
<span class="go">         None</span>
<span class="go">         MLPDecoder (default)</span>
<span class="go">    embedding: WordFeatConfig = WordEmbedding</span>
<span class="go">    inputs: LMLSTM.Config.ModelInput = ModelInput</span>
<span class="go">    output_layer: LMOutputLayer = LMOutputLayer</span>
<span class="go">    representation: (one of)</span>
<span class="go">         DeepCNNRepresentation</span>
<span class="go">         BiLSTM (default)</span>
<span class="go">    stateful: bool</span>
<span class="go">    tied_weights: bool</span>
</pre></div>
</div>
<p>PyText internally registers all the component classes, so we can look up and find any component using the class name or their aliases. For example somewhere in PyText we have <code class="xref py py-class docutils literal notranslate"><span class="pre">import</span> <span class="pre">DeepCNNRepresentation</span> <span class="pre">as</span> <span class="pre">CNN</span></code>, so we would normally look up <code class="xref py py-class docutils literal notranslate"><span class="pre">DeepCNNRepresentation</span></code>, but if we know that this class has an alias we can look up <code class="xref py py-class docutils literal notranslate"><span class="pre">CNN</span></code> instead, and print the information about this class:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext help-config CNN
<span class="go">=== pytext.models.representations.deepcnn.DeepCNNRepresentation (RepresentationBase) ===</span>
<span class="go">"""</span>
<span class="go">`DeepCNNRepresentation` implements CNN representation layer</span>
<span class="go">    preceded by a dropout layer. CNN representation layer is based on the encoder</span>
<span class="go">    in the architecture proposed by Gehring et. al. in Convolutional Sequence to</span>
<span class="go">    Sequence Learning.</span>

<span class="go">    Args:</span>
<span class="go">        config (Config): Configuration object of type DeepCNNRepresentation.Config.</span>
<span class="go">        embed_dim (int): The number of expected features in the input.</span>
<span class="go">"""</span>
<span class="go">    cnn: CNNParams = CNNParams</span>
<span class="go">    dropout: float = 0.3</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-config-file">
<h2>Creating a Config File<a class="headerlink" href="#creating-a-config-file" title="Permalink to this headline">¶</a></h2>
<p>The command <code class="docutils literal notranslate"><span class="pre">gen-default-config</span></code> creates a json config files for a given <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> using the default value for all the parameters. You must specify the class name of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code>. The json config will be printed in the terminal, so you need to send it to a file using of your choice (for example <code class="docutils literal notranslate"><span class="pre">my_config.json</span></code>) to be able to <a class="reference external" href="config_files.html">edit it and use it</a>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">...</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">help-config</span> <span class="pre">LMLSTM</span></code> above, we see that <cite>representation</cite> is by default <code class="xref py py-class docutils literal notranslate"><span class="pre">BiLSTM</span></code>, but could also be <code class="xref py py-class docutils literal notranslate"><span class="pre">DeepCNNRepresentation</span></code>. (This can be because the type is declared as a <cite>Union</cite> of valid alternatives, or because the type is a base class.) Those two classes will have different parameters, so we can’t just edit the <cite>my_config.json</cite> and replace the class name.</p>
<p>We can specify which components to use by adding any number of class names to the command. Let’s create this config, and we’ll use add <code class="xref py py-class docutils literal notranslate"><span class="pre">DeepCNNRepresentation</span></code> to our command. <code class="docutils literal notranslate"><span class="pre">gen-default-config</span></code> will look up this class name and find that it is a suitable <cite>representation</cite> component for the <code class="xref py py-class docutils literal notranslate"><span class="pre">LMLSTM</span></code> model in our <code class="xref py py-class docutils literal notranslate"><span class="pre">LMTask</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask DeepCNNRepresentation &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">INFO - Applying class option: task-&gt;model-&gt;representation = CNN</span>
<span class="go">...</span>
</pre></div>
</div>
<p>This also works with parameters which are not component class names. You can specify the parameter name and its value, and <code class="docutils literal notranslate"><span class="pre">gen-default-config</span></code> will automatically apply this parameter to the right component.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask <span class="nv">epochs</span><span class="o">=</span><span class="m">200</span>
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">INFO - Applying parameter option to task.trainer.epochs : epochs=200</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Sometimes the same parameter name is used by multiple components. In this case PyText prints the list of those parameters with their full config path. You can then simply use the last part of the path that is enough to differentiate them and pick the one you want. In the next example, we omit the prefix <cite>task.model.</cite> because we don’t need it to find where to apply our parameter <cite>representation.dropout</cite>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask <span class="nv">dropout</span><span class="o">=</span><span class="m">0</span>.7 &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">...</span>
<span class="go">Exception: Multiple possibilities for dropout=0.7: task.model.representation.dropout, task.model.decoder.dropout</span>

<span class="gp">$</span> pytext gen-default-config LMTask representation.dropout<span class="o">=</span><span class="m">0</span>.7 &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">INFO - Applying parameter option to task.model.representation.dropout : representation.dropout=0.7</span>
<span class="go">...</span>
</pre></div>
</div>
<p>You can add any number and combination of those parameters. Please note that they will be applied in order, so if you want to change a component class and some of its parameters, you must specify the parameters in this order (component first, then parameters). If you don’t do that, your parameters changes will be ignored. For example, changing <cite>representation.dropout</cite> first, then overriding the representation component will replace the default representation with a new <code class="xref py py-class docutils literal notranslate"><span class="pre">CNN</span></code> component with all the parameter using the default value.</p>
<p>Look at this bad example: you can verify that the representation dropout is 0.3 (the default value for <code class="xref py py-class docutils literal notranslate"><span class="pre">CNN</span></code>) and not 0.7 as we specified, because CNN was applied after and replaced the component that had its dropout modified first.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask representation.dropout<span class="o">=</span><span class="m">0</span>.7 CNN &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">INFO - Applying parameter option to task.model.representation.dropout : representation.dropout=0.7</span>
<span class="go">INFO - Applying class option: task-&gt;model-&gt;representation = CNN</span>
<span class="go">...</span>
</pre></div>
</div>
<p>Now let’s combine everything:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext gen-default-config LMTask BlockShardedTSVDataSource CNN <span class="nv">dilated</span><span class="o">=</span>True <span class="nv">epochs</span><span class="o">=</span><span class="m">200</span> representation.dropout<span class="o">=</span><span class="m">0</span>.7 &gt; my_config.json
<span class="go">INFO - Applying task option: LMTask</span>
<span class="go">INFO - Applying class option: task-&gt;data-&gt;source = BlockShardedTSVDataSource</span>
<span class="go">INFO - Applying class option: task-&gt;model-&gt;representation = CNN</span>
<span class="go">INFO - Applying parameter option to task.model.representation.cnn.dilated : dilated=True</span>
<span class="go">INFO - Applying parameter option to task.trainer.epochs : epochs=200</span>
<span class="go">INFO - Applying parameter option to task.model.representation.dropout : representation.dropout=0.2</span>
<span class="go">...</span>
</pre></div>
</div>
</div>
<div class="section" id="updating-a-config-file">
<h2>Updating a Config File<a class="headerlink" href="#updating-a-config-file" title="Permalink to this headline">¶</a></h2>
<p>When there’s a new release of PyText, some component parameters might change because of bug fixes or new features. While PyText has <cite>config_adapters</cite> that can internally transform old configs to map them to the latest components, it is sometimes useful to update your config file to the current version. This can be done with the command <code class="docutils literal notranslate"><span class="pre">update-config</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pytext update-config &lt; my_config_old.json &gt; my_config_new.json
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyText</a></h1>
<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_your_first_model.html">Train your first model</a></li>
<li class="toctree-l1"><a class="reference internal" href="execute_your_first_model.html">Execute your first model</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualize_your_model.html">Visualize Model Training with TensorBoard</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytext_models_in_your_app.html">Use PyText models in your app</a></li>
<li class="toctree-l1"><a class="reference internal" href="serving_models_in_production.html">Serve Models in Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_files.html">Config Files Explained</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Config Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">Training More Advanced Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="atis_tutorial.html">Train Intent-Slot model on ATIS Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="hierarchical_intent_slot_tutorial.html">Hierarchical intent and slot filling</a></li>
<li class="toctree-l1"><a class="reference internal" href="disjoint_multitask_tutorial.html">Multitask training with disjoint datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed_training_tutorial.html">Data Parallel Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="xlm_r.html">XLM-RoBERTa</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending PyText</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasource_tutorial.html">Custom Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensorizer.html">Custom Tensorizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="dense.html">Using External Dense Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_new_model.html">Creating A New Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="hacking_pytext.html">Hacking PyText</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configs/pytext.html">pytext</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/pytext.html">pytext package</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="config_files.html" title="previous chapter">Config Files Explained</a></li>
<li>Next: <a href="atis_tutorial.html" title="next chapter">Train Intent-Slot model on ATIS Dataset</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" name="q" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div></div>